import hashlib
import os

from selenium import webdriver
import time,re
import requests

from scrapy_baidu.commom.save_video import save_haokan

headers = {
    # 'cookie': 'BIDUPSID=8FC47947011F57D9176BCA81E2579A7E; PSTM=1665110861; BAIDUID=8FC47947011F57D9B1BD66F5BDE28225:FG=1; H_WISE_SIDS=110085_204427_204916_209568_210321_212295_212740_212868_213039_213360_214796_215730_216845_216941_217168_218549_219245_219565_219942_219946_220017_220663_221479_221795_221874_222299_222425_222625_223064_223211_223683_223906_224046_224077_224086_224159_224456_224633_225564_225593_225764_225846_225860_226006_226102_226270_226550_226628_226718_226815_226965_227063_227187_227515_227528_227747_227865_227869_227932_227941_227973_228138_228369_228380_228424_228507_228774_228807_228833_228978_229029_229033_229062_229125_229154_229286_229411_229525_229685_229750_229914_229918_229938_229967_230020_230040_230089_230237_230240_230244_230249_230305_230437_230468_230544_230686_230707_230861_230911_230930; BDUSS=dtV000TVE1d210Z1VMZnduZEJHUm1HM24tdjFETWNWVFlTYnNTTDFheGphWU5qSVFBQUFBJCQAAAAAAAAAAAEAAAA5mBxx7bntue257bntue25MQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGPcW2Nj3FtjNX; BDUSS_BFESS=dtV000TVE1d210Z1VMZnduZEJHUm1HM24tdjFETWNWVFlTYnNTTDFheGphWU5qSVFBQUFBJCQAAAAAAAAAAAEAAAA5mBxx7bntue257bntue25MQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGPcW2Nj3FtjNX; Hm_lvt_4aadd610dfd2f5972f1efee2653a2bc5=1666330671,1667054298; hkpcSearch=%u6B27%u7F8E%u7535%u5F71%24%24%24%u6B27%u7F8E; PC_TAB_LOG=video_details_page; COMMON_LID=48664518cf6f29d4bc6ef0499309effd; BAIDUID_BFESS=8FC47947011F57D9B1BD66F5BDE28225:FG=1; ZFY=Ppbkz99J6k5Hbe9YC7MvSARqGb6:BjY6aFsPIrJDMi:BI:C; delPer=0; PSINO=5; BCLID=8279814679575894301; BCLID_BFESS=8279814679575894301; BDSFRCVID=GkLOJexroG06EKOjDF8OU9Ok3eKKg9TTDYLEOwXPsp3LGJLVcjg-EG0Pt8i0Cou-dk83ogKKL2OTHmuF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; BDSFRCVID_BFESS=GkLOJexroG06EKOjDF8OU9Ok3eKKg9TTDYLEOwXPsp3LGJLVcjg-EG0Pt8i0Cou-dk83ogKKL2OTHmuF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF=fR-f_D_5fIvDqTrP-trf5DCShUFs26ORB2Q-XPoO3Kt-sqvOMxOShq4AetnWJ-QiWKk8-UbgylRp8P3y0bb2DUA1y4vp5-TMHmTxoUJ2fnI2En7GqtOOe5tebPRiWTj9QgbLLlQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0bDP6j6Kbe5PVKgTa54cbb4o2WbCQQf-28pcN2b5oQTOBQtR9af3QaC5PVl7otb5vOn0w3hOUWfAkXpJvQnJjt2JxaqRCKbcJKq5jDh3Me-cQLUnte43Wfn7y0hvcBIocShnz5fjrDRLbXU6BK5vPbNcZ0l8K3l02V-bIe-t2XjQheHAftjDffn3aQ5rtKRTffjrnhPF3WqJ3XP6-hnjy3b4qKlvv2qbSsR6aefnODPLUyUt8Lp3RymJ42-39LPO2hpRjyxv4-PIsqtoxJpOJfIKj5b7aHRbObKOvbURvX5Dg3-7L-x5dtjTO2bc_5KnlfMQ_bf--QfbQ0hOhqP-jBRIEVCP5JD_bbKvPKITD-tFO5eT22-usyCOr2hcHMPoosItCQfRcMx0jbtJPqxRWtKTiab0XQUbUoqRHXnJi0btQDPvxBf7pKKQMsl5TtUJMbbIxLPnhqt0feabyKMniBnr9-pnEblQrh459XP68bTkA5bjZKxtq3mkjbPbDfn028DKuejAbj6jWeaRabK6aKC5bL6rJabC3snvsXU6q2bDeQN0q0xn92enlVp7Gfl7Ohn5oyPtB3h0vWtv4WbbvLT7johRTWqR4HncTqfonDh83eMuj3-RtHCnWVIOO5hvv8KoO3M7V5fKmDloOW-TB5bbPLUQF5l8-sq0x0bOte-bQXH_E5bj2qRA8_K-53j; H_BDCLCKID_SF_BFESS=fR-f_D_5fIvDqTrP-trf5DCShUFs26ORB2Q-XPoO3Kt-sqvOMxOShq4AetnWJ-QiWKk8-UbgylRp8P3y0bb2DUA1y4vp5-TMHmTxoUJ2fnI2En7GqtOOe5tebPRiWTj9QgbLLlQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0bDP6j6Kbe5PVKgTa54cbb4o2WbCQQf-28pcN2b5oQTOBQtR9af3QaC5PVl7otb5vOn0w3hOUWfAkXpJvQnJjt2JxaqRCKbcJKq5jDh3Me-cQLUnte43Wfn7y0hvcBIocShnz5fjrDRLbXU6BK5vPbNcZ0l8K3l02V-bIe-t2XjQheHAftjDffn3aQ5rtKRTffjrnhPF3WqJ3XP6-hnjy3b4qKlvv2qbSsR6aefnODPLUyUt8Lp3RymJ42-39LPO2hpRjyxv4-PIsqtoxJpOJfIKj5b7aHRbObKOvbURvX5Dg3-7L-x5dtjTO2bc_5KnlfMQ_bf--QfbQ0hOhqP-jBRIEVCP5JD_bbKvPKITD-tFO5eT22-usyCOr2hcHMPoosItCQfRcMx0jbtJPqxRWtKTiab0XQUbUoqRHXnJi0btQDPvxBf7pKKQMsl5TtUJMbbIxLPnhqt0feabyKMniBnr9-pnEblQrh459XP68bTkA5bjZKxtq3mkjbPbDfn028DKuejAbj6jWeaRabK6aKC5bL6rJabC3snvsXU6q2bDeQN0q0xn92enlVp7Gfl7Ohn5oyPtB3h0vWtv4WbbvLT7johRTWqR4HncTqfonDh83eMuj3-RtHCnWVIOO5hvv8KoO3M7V5fKmDloOW-TB5bbPLUQF5l8-sq0x0bOte-bQXH_E5bj2qRA8_K-53j; __bid_n=1843dd9428d2b6ddfd4207; BAIDU_WISE_UID=wapp_1667484959763_397; BDRCVFR[X_XKQks0S63]=mk3SLVN4HKm; userFrom=null; BDRCVFR[K-_II4leN16]=mk3SLVN4HKm; Hm_lpvt_4aadd610dfd2f5972f1efee2653a2bc5=1667728209; ariaDefaultTheme=undefined; H_PS_PSSID=; BA_HECTOR=a124a18100aka480ag0g8u3i1hmf1ul1f; BDORZ=FFFB88E999055A3F8A630C64834BD6D0; RT="sl=0&ss=la56bd14&tt=0&bcn=https%3A%2F%2Ffclog.baidu.com%2Flog%2Fweirwood%3Ftype%3Dperf&z=1&dm=baidu.com&si=873022d8-e739-444b-a190-49bddd3af82f&ld=2msbmd&ul=u8ce&hd=u8vv"',
    'cookie':'BIDUPSID=8FC47947011F57D9176BCA81E2579A7E; PSTM=1665110861; BAIDUID=8FC47947011F57D9B1BD66F5BDE28225:FG=1; H_WISE_SIDS=110085_204427_204916_209568_210321_212295_212740_212868_213039_213360_214796_215730_216845_216941_217168_218549_219245_219565_219942_219946_220017_220663_221479_221795_221874_222299_222425_222625_223064_223211_223683_223906_224046_224077_224086_224159_224456_224633_225564_225593_225764_225846_225860_226006_226102_226270_226550_226628_226718_226815_226965_227063_227187_227515_227528_227747_227865_227869_227932_227941_227973_228138_228369_228380_228424_228507_228774_228807_228833_228978_229029_229033_229062_229125_229154_229286_229411_229525_229685_229750_229914_229918_229938_229967_230020_230040_230089_230237_230240_230244_230249_230305_230437_230468_230544_230686_230707_230861_230911_230930; BDUSS=dtV000TVE1d210Z1VMZnduZEJHUm1HM24tdjFETWNWVFlTYnNTTDFheGphWU5qSVFBQUFBJCQAAAAAAAAAAAEAAAA5mBxx7bntue257bntue25MQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGPcW2Nj3FtjNX; BDUSS_BFESS=dtV000TVE1d210Z1VMZnduZEJHUm1HM24tdjFETWNWVFlTYnNTTDFheGphWU5qSVFBQUFBJCQAAAAAAAAAAAEAAAA5mBxx7bntue257bntue25MQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGPcW2Nj3FtjNX; Hm_lvt_4aadd610dfd2f5972f1efee2653a2bc5=1666330671,1667054298; hkpcSearch=%u6B27%u7F8E%u7535%u5F71%24%24%24%u6B27%u7F8E; PC_TAB_LOG=video_details_page; COMMON_LID=48664518cf6f29d4bc6ef0499309effd; BDORZ=FFFB88E999055A3F8A630C64834BD6D0; H_PS_PSSID=26350; hkpcvideolandquery=%u96FE%u91CC%u770B%u82B1%u7B2C1%u96C6%20; BD_SVTK=WteO3EWWnfkYlotW3WZa108dO0fc0P0jflOml8f9ZWAoQnfD9tPq0tlyO8fAlPlX0kgA1AQaTA59QnfD9fj2JH0JPifNlP0StJPxlSicx0HLpO07SlFQJHlijlfYljJZS8OSf8tleWEAQgiY00n1190Mj3fZiP0JE0PRiCI8kaamB; delPer=0; PSINO=5; BA_HECTOR=818l01a0a50h00a58g8124d21hmfaok1f; ZFY=Ppbkz99J6k5Hbe9YC7MvSARqGb6:BjY6aFsPIrJDMi:BI:C; BAIDUID_BFESS=8FC47947011F57D9B1BD66F5BDE28225:FG=1; BCLID=8478522264953980953; BCLID_BFESS=8478522264953980953; BDSFRCVID=PwDOJexroG0GmHrjj1tKU9Ok3eKK0gOTDYLEJs2qYShnrsPVJeC6EG0PtoWQkz--EHtdogKKL2OTHmuF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; BDSFRCVID_BFESS=PwDOJexroG0GmHrjj1tKU9Ok3eKK0gOTDYLEJs2qYShnrsPVJeC6EG0PtoWQkz--EHtdogKKL2OTHmuF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF=fR-f_D_5fIvDqTrP-trf5DCShUFsLq0jB2Q-XPoO3Kt-sqvOMxOShtFAetnWJ-QiWKk8-UbgylRp8P3y0bb2DUA1y4vp5-TMHmTxoUJ2fnI2En7GqtOOe5tebPRiWTj9QgbLLlQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0bDP6j6Kbe5PVKgTa54cbb4o2WbCQyx8M8pcN2b5oQTOBQtR9af3Q3DjPVl7otb5vOn0w3hOUWfAkXpJvQnJjt2JxaqRCKbcJKq5jDh3Me-cQLUnte43Wfn7y0hvcBIocShnz5fjrDRLbXU6BK5vPbNcZ0l8K3l02V-bIe-t2XjQheHAftjDffn3aQ5rtKRTffjrnhPF3Wt4TXP6-hnjy3b4qKlvv2qbSeq3aefnODPLUyUt8Lp3RymJ42-39LPO2hpRjyxv4-PIsqtoxJpOJfIKj5b7aHRbObKOvbURvX5Dg3-7L-x5dtjTO2bc_5KnlfMQ_bf--QfbQ0hOhqP-jBRIEVCP5JD_bbKvPKITD-tFO5eT22-us3K3r2hcHMPoosItCQfRcMx0ze-nPqxRWtKTiab0XQUbUoqRHXnJi0btQDPvxBf7pKKQMsl5TtUJMbbIxLPnhqt0feabyKMniBnr9-pnEblQrh459XP68bTkA5bjZKxtq3mkjbPbDfn028DKuDjRs-t4f-fIX5to05TIX3b7EfMJbsh7_bJ7KhUbQQUc7btTBt6ni-CTv2KOqOpkxbUnxQhFTQt6eJJokLKbXQtOxQqcqEIQHQT3m5-4i0fREeCr4WTnbWb3cWh4K8UbShJoPBTD02-nBat-OQ6npaJ5nJq5nhMJmb67JDMr0exbH55uqtRIOoM5; H_BDCLCKID_SF_BFESS=fR-f_D_5fIvDqTrP-trf5DCShUFsLq0jB2Q-XPoO3Kt-sqvOMxOShtFAetnWJ-QiWKk8-UbgylRp8P3y0bb2DUA1y4vp5-TMHmTxoUJ2fnI2En7GqtOOe5tebPRiWTj9QgbLLlQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0bDP6j6Kbe5PVKgTa54cbb4o2WbCQyx8M8pcN2b5oQTOBQtR9af3Q3DjPVl7otb5vOn0w3hOUWfAkXpJvQnJjt2JxaqRCKbcJKq5jDh3Me-cQLUnte43Wfn7y0hvcBIocShnz5fjrDRLbXU6BK5vPbNcZ0l8K3l02V-bIe-t2XjQheHAftjDffn3aQ5rtKRTffjrnhPF3Wt4TXP6-hnjy3b4qKlvv2qbSeq3aefnODPLUyUt8Lp3RymJ42-39LPO2hpRjyxv4-PIsqtoxJpOJfIKj5b7aHRbObKOvbURvX5Dg3-7L-x5dtjTO2bc_5KnlfMQ_bf--QfbQ0hOhqP-jBRIEVCP5JD_bbKvPKITD-tFO5eT22-us3K3r2hcHMPoosItCQfRcMx0ze-nPqxRWtKTiab0XQUbUoqRHXnJi0btQDPvxBf7pKKQMsl5TtUJMbbIxLPnhqt0feabyKMniBnr9-pnEblQrh459XP68bTkA5bjZKxtq3mkjbPbDfn028DKuDjRs-t4f-fIX5to05TIX3b7EfMJbsh7_bJ7KhUbQQUc7btTBt6ni-CTv2KOqOpkxbUnxQhFTQt6eJJokLKbXQtOxQqcqEIQHQT3m5-4i0fREeCr4WTnbWb3cWh4K8UbShJoPBTD02-nBat-OQ6npaJ5nJq5nhMJmb67JDMr0exbH55uqtRIOoM5; ab_sr=1.0.1_ZGFhMTIzNGU3NDkxMGIwZmY2NTAzNWJmNmU3Y2YwMTExZjU2ZjhkY2UyMzNmNmUxZTE3ZGY2MDg2OTE1OTQ4NzBjOTI3YWIyZmNkYTFkYWNmYjU5N2FiNGZlZjllNzQyOGRhMTQ5ZWVhZDllNTI1NGVkYmJmMmNkNTBmZTYzMGY3ZjFiOGEwZjU3YTI2ZWViZDYxMGQzYmI0NTUxNGM4Zg==; reptileData=%7B%22data%22%3A%22a4925e90b6e2dc93225045e44f90e728521c8d354952f17d4325d19acb9b59b7efdc9004ed0ab0201593cdb7eea807c27d662dd79cc272dc12faf2ad7e75d834d1e0fd5e098fac8cdb38706a309b4583efc3418904143eeb2c07b6410d176153%22%2C%22key_id%22%3A%2230%22%2C%22sign%22%3A%22d15d8138%22%7D; Hm_lpvt_4aadd610dfd2f5972f1efee2653a2bc5=1667739144; ariaDefaultTheme=undefined; RT="z=1&dm=baidu.com&si=pdb9vu3dnp&ss=la5cto9y&sl=2&tt=1ur&bcn=https%3A%2F%2Ffclog.baidu.com%2Flog%2Fweirwood%3Ftype%3Dperf&ld=45w"',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36',
    'host' : 'haokan.baidu.com',
}
while True:
    # for i in range(26,50):
    for i in range(1,50):
        print(i)
        # url = 'https://haokan.baidu.com/web/search/api?pn='+str(i)+'&rn=10&type=video&query=%E6%AC%A7%E7%BE%8E%E7%94%B5%E5%BD%B1'
        url = 'https://haokan.baidu.com/web/search/api?pn='+str(i)+'&rn=10&type=video&query=%E6%AC%A7%E7%BE%8E'
        # url = 'https://haokan.baidu.com/web/search/api?pn=1&rn=10&type=video&query=%E6%AC%A7%E7%BE%8E%E7%94%B5%E5%BD%B1'
        # url = 'https://haokan.baidu.com/web/search/page?query=%E6%AC%A7%E7%BE%8E%E7%94%B5%E5%BD%B1'
        print(url)
        response = requests.get(url=url, headers=headers)
        res = response.json()
        print(res)
        if res:
            video_urls = res.get('data').get('list')
            print(video_urls)
            for video_url in video_urls:
                duration = video_url.get('duration')
                title = video_url.get('title')
                href = video_url.get('url')
                target = video_url.get('vid')
                save_haokan(title, href, target, duration, 3)
